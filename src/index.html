<html>
  <head>
    <meta charset="utf-8">
    <title>Chart Designer</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.4/jquery.datetimepicker.css" />
    <script src="//d3js.org./d3.v3.min.js"></script>
    <script src="//vega.github.io/vega/vega.js"></script>
    <script src="//vega.github.io/vega-lite/vega-lite.js"></script>
    <script src="//vega.github.io/vega-editor/vendor/vega-embed.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.4/build/jquery.datetimepicker.full.min.js"></script>
    <style>
      .designer {
        padding-top: 10px;
        padding-left: 10px;
        display: block;
      }      
      .space-between {
        width: 100px;
        color: #FFFFFF;
        margin-left: 10px;
        margin-right: 10px;
      }
      #button {
        -webkit-border-radius: 28;
        -moz-border-radius: 28;
        border-radius: 28px;
        font-family: Arial;
        color: #FFFFFF;
        font-size: 15px;
        background: #00A800;
        padding: 8px 15px 8px 15px;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <div class="designer">
      <form action="">
        Offering:
        <select id="offering">
          <option>offering1</option>
        </select>
        <hr class="space-between" />

        Procedure:
        <select id="procedure">
          <option>MI_Lambrate_Precipitazione</option>
          <option>MI_Lambrate_Temperatura</option>
        </select>
        <hr class="space-between" />

        Observed Property:
        <select id="property">
          <option>temperature</option>
          <option>rainfall</option>
        </select>
        <hr class="space-between" />
        
        From:
        <input id="datetimepicker-from" type="text" />
        <select id="tzoffset"> 
          <option>-03:00</option>
          <option>-02:00</option>
          <option>-01:00</option>
          <option>+00:00</option>
          <option>+01:00</option>
          <option>+02:00</option>
          <option>+03:00</option>
          <option>+03:30</option>
        </select>
        <hr class="space-between" />
        
        To:
        <input id="datetimepicker-to" type="text" />
        <hr class="space-between" />

        Chart type:
        <div>
          <input type="radio" name="chart" value="line" id="line">
          <label for="line">Line</label>
        </div>
        <div>
          <input type="radio" name="chart" value="bar" id="bar">
          <label for="bar">Bar</label>
        </div>
        <div>
          <input type="radio" name="chart" value="punch-card" id="punch-card">
          <label for="punch-card">Punch Card</label>
        </div>
        <div>
          <input type="radio" name="chart" value="scatterplot" id="scatterplot">
          <label for="scatterplot">Scatterplot</label>
        </div>
        <div>
          <input type="radio" name="chart" value="overview-detail" id="overview-detail">
          <label for="overview-detail">Overview Detail</label>
        </div>
      </form>

      <input type="button" id="button" value="Configure" />

      <h3>Embedded Chart:</h3>
      <textarea id="txt-iframe" rows="5" cols="45" readonly></textarea>
    </div>
    
    <script type="text/javascript">
      var chartType = "";
      var property = "";
      var from = "";
      var tzoffset = "";
      var to = "";

      jQuery("#datetimepicker-from").datetimepicker({formatDate: "Y-m-dT", formatTime: "H:i"});
      jQuery("#datetimepicker-to").datetimepicker();
     
      $("input").on("click", function() {
        chartType = $("input:checked").val();
      });
 
      $("#button").click(function() {
        property = $("#property").val();
        from = $("#datetimepicker-from").val().replace(/\//g, "-").replace(" ", "T");
        tzoffset = $("#tzoffset").val() 
        to = $("#datetimepicker-to").val().replace(/\//g, "-").replace(" ", "T");

        var chartUrl = "http://131.175.143.71/charts/src/default-widget.html?" + 
                       "chart=" + chartType + 
                       "&property=" + property + 
                       "&from=" + from +  
                       "&until=" + to;
        var iframe = "<iframe name='istSOS-chart' src='" + chartUrl + "' width='720' height='480' scrolling='no' frameborder='0'></iframe>";

        $("#txt-iframe").val(iframe);
      });
    </script>
  </body>
</html>
